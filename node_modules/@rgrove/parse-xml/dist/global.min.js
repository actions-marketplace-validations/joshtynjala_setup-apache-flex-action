/*! @rgrove/parse-xml v4.0.1 | ISC License | Copyright Ryan Grove */
"use strict";var parseXml=(()=>{var X=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var J=Object.getOwnPropertyNames;var U=Object.prototype.hasOwnProperty;var R=(n,t)=>{for(var e in t)X(n,e,{get:t[e],enumerable:!0})},_=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of J(t))!U.call(n,i)&&i!==e&&X(n,i,{get:()=>t[i],enumerable:!(r=M(t,i))||r.enumerable});return n};var Y=n=>_(X({},"__esModule",{value:!0}),n);var W={};R(W,{XmlCdata:()=>d,XmlComment:()=>p,XmlDocument:()=>x,XmlElement:()=>a,XmlNode:()=>s,XmlProcessingInstruction:()=>f,XmlText:()=>u,parseXml:()=>V});var c="",$=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,g=class{constructor(t){if(this.l=this.c(t,!0),this.i=0,this.length=t.length,this.h=this.l!==this.length,this.string=t,this.h){let e=[];for(let r=0,i=0;i<this.l;++i)e[i]=r,r+=t.codePointAt(r)>65535?2:1;this.E=e}}get O(){return this.i>=this.l}f(t=this.i){var e;return this.h?(e=this.E[t])!=null?e:1/0:t}c(t,e=this.h){return e?t.replace($,"_").length:t.length}s(t=1){this.i=Math.min(this.l,this.i+t)}D(t=1){let e=this.o(t);return this.s(t),e}y(t){if(!t.sticky)throw new Error('`regex` must have a sticky flag ("y")');t.lastIndex=this.f();let e=t.exec(this.string);if(e===null||e.length===0)return c;let r=e[0];return this.s(this.c(r)),r}b(t){let e,r=c;for(;(e=this.o())&&t(e);)r+=e,this.s();return r}_(t){if(this.e(t))return t;if(this.h){let{length:e}=t,r=this.c(t);if(r!==e&&t===this.o(r))return this.s(r),t}return c}e(t){let{length:e}=t;return this.o(e)===t?(this.s(e),t):c}T(t){let e=this.string.slice(this.f()),r=e.search(t);if(r<=0)return c;let i=e.slice(0,r);return this.s(this.c(i)),i}p(t){let{string:e}=this,r=this.f(),i=e.indexOf(t,r);if(i<=0)return c;let o=e.slice(r,i);return this.s(this.c(o)),o}o(t=1){let{i:e,h:r,string:i}=this;return r?e>=this.l?c:i.slice(this.f(e),this.f(e+t)):i.slice(e,e+t)}d(t=0){this.i=t>=0?Math.min(this.l,t):Math.max(0,this.i+t)}};var P=/[^"&<]+/y,D=/[^'&<]+/y,T=/[\t\n]/g,j=/<|&|]]>/,S=Object.freeze(Object.assign(Object.create(null),{amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}));function w(n){let t=C(n);return t>=97&&t<=122||t>=65&&t<=90||t>=48&&t<=57||t===45||t===46||t===183||t>=768&&t<=879||t>=8255&&t<=8256||v(n,t)}function v(n,t=C(n)){return t>=97&&t<=122||t>=65&&t<=90||t===58||t===95||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}function I(n){return n==="#"||w(n)}function A(n){let t=C(n);return t===32||t===9||t===10||t===13}function E(n){return n===9||n===10||n===13||n>=32&&n<=55295||n>=57344&&n<=65533||n>=65536&&n<=1114111}function C(n){return n.codePointAt(0)||-1}var s=class{constructor(){this.parent=null}get document(){var t,e;return(e=(t=this.parent)==null?void 0:t.document)!=null?e:null}get isRootNode(){return this.parent!==null&&this.parent===this.document}get preserveWhitespace(){var t;return Boolean((t=this.parent)==null?void 0:t.preserveWhitespace)}get type(){return""}toJSON(){let t={type:this.type};return this.isRootNode&&(t.isRootNode=!0),this.preserveWhitespace&&(t.preserveWhitespace=!0),t}};s.TYPE_CDATA="cdata",s.TYPE_COMMENT="comment",s.TYPE_DOCUMENT="document",s.TYPE_ELEMENT="element",s.TYPE_PROCESSING_INSTRUCTION="pi",s.TYPE_TEXT="text";var u=class extends s{constructor(e=""){super();this.text=e}get type(){return s.TYPE_TEXT}toJSON(){return Object.assign(s.prototype.toJSON.call(this),{text:this.text})}};var d=class extends u{get type(){return s.TYPE_CDATA}};var p=class extends s{constructor(e=""){super();this.content=e}get type(){return s.TYPE_COMMENT}toJSON(){return Object.assign(s.prototype.toJSON.call(this),{content:this.content})}};var a=class extends s{constructor(e,r=Object.create(null),i=[]){super();this.name=e,this.attributes=r,this.children=i}get isEmpty(){return this.children.length===0}get preserveWhitespace(){let e=this;for(;e instanceof a;){if("xml:space"in e.attributes)return e.attributes["xml:space"]==="preserve";e=e.parent}return!1}get text(){return this.children.map(e=>"text"in e?e.text:"").join("")}get type(){return s.TYPE_ELEMENT}toJSON(){return Object.assign(s.prototype.toJSON.call(this),{name:this.name,attributes:this.attributes,children:this.children.map(e=>e.toJSON())})}};var x=class extends s{constructor(e=[]){super();this.children=e}get document(){return this}get root(){for(let e of this.children)if(e instanceof a)return e;return null}get text(){return this.children.map(e=>"text"in e?e.text:"").join("")}get type(){return s.TYPE_DOCUMENT}toJSON(){return Object.assign(s.prototype.toJSON.call(this),{children:this.children.map(e=>e.toJSON())})}};var f=class extends s{constructor(e,r=""){super();this.name=e,this.content=r}get type(){return s.TYPE_PROCESSING_INSTRUCTION}toJSON(){return Object.assign(s.prototype.toJSON.call(this),{name:this.name,content:this.content})}};var O="",y=class{constructor(t,e={}){if(this.document=new x,this.a=this.document,this.options=e,this.r=new g(k(t)),this.j(),!this.C())throw this.t("Root element is missing or invalid");for(;this.X(););if(!this.r.O)throw this.t("Extra content at the end of the document")}m(t){t.parent=this.a,this.a.children.push(t)}w(t){let{children:e}=this.a,{length:r}=e;if(r>0){let i=e[r-1];if(i instanceof u){i.text+=t;return}}this.m(new u(t))}S(){let t=Object.create(null);for(;this.n();){let e=this.x();if(!e)break;let r=this.g()&&this.I();if(r===!1)throw this.t("Attribute value expected");if(e in t)throw this.t(`Duplicate attribute: ${e}`);if(e==="xml:space"&&r!=="default"&&r!=="preserve")throw this.t('Value of the `xml:space` attribute must be "default" or "preserve"');t[e]=r}if(this.options.sortAttributes){let e=Object.keys(t).sort(),r=Object.create(null);for(let i=0;i<e.length;++i){let o=e[i];r[o]=t[o]}t=r}return t}I(){let{r:t}=this,e=t.o();if(e!=='"'&&e!=="'")return!1;t.s();let r,i=!1,o=O,l=e==='"'?P:D;t:for(;!t.O;)switch(r=t.y(l),r&&(this.u(r),o+=r.replace(T," ")),t.o()){case e:i=!0;break t;case"&":o+=this.N();continue;case"<":throw this.t("Unescaped `<` is not allowed in an attribute value");case O:break t}if(!i)throw this.t("Unclosed attribute");return t.s(),o}A(){let{r:t}=this;if(!t.e("<![CDATA["))return!1;let e=t.p("]]>");if(this.u(e),!t.e("]]>"))throw this.t("Unclosed CDATA section");return this.options.preserveCdata?this.m(new d(e)):this.w(e),!0}J(){let{r:t}=this,e=t.T(j);if(!e)return!1;if(this.u(e),t.o(3)==="]]>")throw this.t("Element content may not contain the CDATA section close delimiter `]]>`");return this.w(e),!0}F(){let{r:t}=this;if(!t.e("<!--"))return!1;let e=t.p("--");if(this.u(e),!t.e("-->"))throw t.o(2)==="--"?this.t("The string `--` isn't allowed inside a comment"):this.t("Unclosed comment");return this.options.preserveComments&&this.m(new p(e.trim())),!0}M(){let t=this.N();return t?(this.w(t),!0):!1}U(){let{r:t}=this;if(!t.e("<!DOCTYPE")||!this.n())return!1;if(t.y(/[^[>]+/y),t.y(/\[[\s\S]+?\][\x20\t\r\n]*>/y))return!0;if(!t.e(">"))throw this.t("Unclosed doctype declaration");return!0}C(){let{r:t}=this,e=t.i;if(!t.e("<"))return!1;let r=this.x();if(!r)return t.d(e),!1;let i=this.S(),o=Boolean(t.e("/>")),l=new a(r,i);if(l.parent=this.a,!o){if(!t.e(">"))throw this.t(`Unclosed start tag for element \`${r}\``);this.a=l;do this.J();while(this.C()||this.M()||this.A()||this.P()||this.F());let h=t.i,m;if(!t.e("</")||!(m=this.x())||m!==r)throw t.d(h),this.t(`Missing end tag for element ${r}`);if(this.n(),!t.e(">"))throw this.t(`Unclosed end tag for element ${r}`);this.a=l.parent}return this.m(l),!0}g(){return this.n(),this.r.e("=")?(this.n(),!0):!1}X(){return this.F()||this.P()||this.n()}x(){return v(this.r.o())?this.r.b(w):O}P(){let{r:t}=this,e=t.i;if(!t.e("<?"))return!1;let r=this.x();if(r){if(r.toLowerCase()==="xml")throw t.d(e),this.t("XML declaration isn't allowed here")}else throw this.t("Invalid processing instruction");if(!this.n()){if(t.e("?>"))return this.m(new f(r)),!0;throw this.t("Whitespace is required after a processing instruction name")}let i=t.p("?>");if(this.u(i),!t.e("?>"))throw this.t("Unterminated processing instruction");return this.m(new f(r,i)),!0}j(){let{r:t}=this,e=t.i;for(this.R();this.X(););if(this.U())for(;this.X(););return e<t.i}N(){let{r:t}=this;if(!t.e("&"))return!1;let e=t.b(I);if(t.D()!==";")throw this.t("Unterminated reference (a reference must end with `;`)");let r;if(e[0]==="#"){let i=e[1]==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10);if(isNaN(i))throw this.t("Invalid character reference");if(!E(i))throw this.t("Character reference resolves to an invalid character");r=String.fromCodePoint(i)}else if(r=S[e],r===void 0){let{ignoreUndefinedEntities:i,resolveUndefinedEntity:o}=this.options,l=`&${e};`;if(o){let h=o(l);if(h!=null){let m=typeof h;if(m!=="string")throw new TypeError(`\`resolveUndefinedEntity()\` must return a string, \`null\`, or \`undefined\`, but returned a value of type ${m}`);return h}}if(i)return l;throw t.d(-l.length),this.t(`Named entity isn't defined: ${l}`)}return r}v(){let{r:t}=this,e=t.e('"')||t.e("'");if(!e)return!1;let r=t.p(e);if(this.u(r),!t.e(e))throw this.t("Missing end quote");return r}n(){return Boolean(this.r.b(A))}R(){let{r:t}=this;if(!t.e("<?xml"))return!1;if(!this.n())throw this.t("Invalid XML declaration");let e=Boolean(t.e("version"))&&this.g()&&this.v();if(e===!1)throw this.t("XML version is missing or invalid");if(!/^1\.[0-9]+$/.test(e))throw this.t("Invalid character in version number");if(this.n()){Boolean(t.e("encoding"))&&this.g()&&this.v()&&this.n();let i=Boolean(t.e("standalone"))&&this.g()&&this.v();if(i){if(i!=="yes"&&i!=="no")throw this.t('Only "yes" and "no" are permitted as values of `standalone`');this.n()}}if(!t.e("?>"))throw this.t("Invalid or unclosed XML declaration");return!0}t(t){let{i:e,string:r}=this.r,i=1,o="",l=1;for(let b=0;b<e;++b){let F=r[b];F===`
`?(i=1,o="",l+=1):(i+=1,o+=F)}let h=r.indexOf(`
`,e);o+=h===-1?r.slice(e):r.slice(e,h);let m=0;o.length>50&&(i<40?o=o.slice(0,50):(m=i-20,o=o.slice(m,i+30)));let N=new Error(`${t} (line ${l}, column ${i})
  ${o}
`+" ".repeat(i-m+1)+`^
`);return Object.assign(N,{column:i,excerpt:o,line:l,pos:e}),N}u(t){let{length:e}=t;for(let r=0;r<e;++r){let i=t.codePointAt(r);if(!E(i))throw this.r.d(-([...t].length-r)),this.t("Invalid character");i>65535&&(r+=1)}}};function k(n){return n[0]==="\uFEFF"&&(n=n.slice(1)),n.replace(/\r\n?/g,`
`)}function V(n,t){return new y(n,t).document}return Y(W);})();
parseXml=parseXml.parseXml
//# sourceMappingURL=global.min.js.map
